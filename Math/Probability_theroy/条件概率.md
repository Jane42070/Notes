
<!-- vim-markdown-toc GFM -->

* [条件概率](#条件概率)
	* [定义](#定义)
	* [性质](#性质)
	* [乘法定理](#乘法定理)
	* [例题](#例题)
* [全概率公式与贝叶斯公式](#全概率公式与贝叶斯公式)
	* [样本空间的划分](#样本空间的划分)
	* [全概率公式](#全概率公式)
	* [例题](#例题-1)
	* [贝叶斯公式](#贝叶斯公式)
	* [例题](#例题-2)

<!-- vim-markdown-toc -->

# 条件概率
1. 将一枚硬币抛掷两次，观察其出现正反两面的情况，设事件 A 为“至少有一次为正面”，事件 B 为”两次掷出同一面”。现在来求已知事件 A 已经发生条件下事件 B 发生的概率。
	- 分析	$S = \lbrace HH, HT, TH, TT \rbrace$
	- $A = \lbrace HH, HT, TH \rbrace ,  B = \lbrace HH, TT \rbrace$, $P(B) = \frac{2}{4} = \frac{1}{2}$
	- 事件 A 已经发生的条件下事件 B 发生的概率
		- 记为 $P(B|A)$，则 $P(B|A)=\frac{1}{3}=\frac{\frac{1}{4}}{\frac{3}{4}}=\frac{P(AB)}{P(A)} \neq P(B)$
## 定义
- 设 A，B 是两个事件，且 $P(A) > 0$, 称
- $P(B|A)=\frac{P(AB)}{P(A)}$
- 同理可得
- $P(A|B)=\frac{P(AB)}{P(B)}$
- 为事件 B 事件下事件 A 发生的条件概率。

## 性质
1. 非负性：$P(B|A) \geq 0$
1. 规范性：$P(S|A) = 1, P(\phi|A) = 0$
1. $P(B_1 \bigcup B_2|A) = P(B_1|A) + P(B_2|A) - P(B_1B_2|A)$
1. $P(B|A) = 1 - P(B^-|A)$
1. **可列可加性：设** $B_1, B_2 \cdots是两两不相容的事件，则有$ [1](./1.png)

## 乘法定理
1. $P(A) > 0 则有 P(AB) = P(B|A)P(A)$
1. 设 $A, B, C 为事件，且 P(AB) > 0, 则有 P(ABC) = P(C|AB) P(B|A) P(A)$
1. 推广 设 $A_1, A_2, \cdots, A_n 为 n 个事件，n \geq 2, 且 P(A_1 A_2 \cdots A_{n-1}) > 0, 则有：$
- $P(A_1 A_2 \cdots A_n) = P(A_n|A_1 A_2 \cdots A_{n-1}) \times P(A_{n-1}|A_1 A_2 \cdots A_{n-2})\times \cdots \times P(A_2|A_1) P(A_1)$

## 例题
- 例 1：一盒子装有 4 只产品，其中有 3 只一等品、1 只二等品，从中取产品两次，每次任取一只，做不放回抽样，设事件 A 为“第一次取到的是一等品”、事件 B 为“第二次取到的是一等品”。试求条件概率 $P(B|A)$
	- 当时间 A 发生时，盒子内共有 3 只产品，一等品只有 2 只了，故 $P(B|A) = \frac{2}{3}$

- 例 2：某种动物由出生算起活 20 岁以上的概率为 0.8，活到 25 岁以上的概率为 0.4，如果现在有一个 20 岁的这种动物，问他能活到 25 岁以上的概率是多少？
	- 设 A 表示“能活 20 岁以上” 的事件，B 表示"能活 25 岁以上" 的事件，则有 $P(B|A) = \frac{P(AB)}{P(A)}$
	- 因为 $P(A) = 0.8, P(B) = 0.4, P(AB) = P(B)$
	- 所以 $P(B|A) = \frac{P(AB)}{P(A)} = \frac{0.4}{0.8} = \frac{1}{2}$

- 例 3：五个阄，其中两个阄内写着“有”字，三个阄内不写字，五个人一次抓取，问个人抓到“有”字阄的概率是否相同。
	- 设 $A_i$ 表示“第i 人抓到有字阄”的事件，
	- $i = 1, 2, 3, 4, 5$ 则有：$P(A_1) = \frac{2}{5}$,
	- $P(A_2) = P(A_2S) = P(A_2 \bigcap (A_1 \bigcup A_1^-))$
	<br>$=P(A_1A_2 \bigcup A_1^-A_2) = P(A_1A_2) + P(A_1^-A_2)$
	<br>$=P(A_1)P(A_2|A_1) + P(A_1^-)P(A_2|A_1^-)$
	<br>$= \frac{2}{5} \times \frac{1}{4} + \frac{3}{5} \times \frac{2}{4} = \frac{2}{5}$
	- 以此类推：$P(A_4) = P(A_5) = \frac{2}{5}$
	- 与抓阄顺序无关

- 例 4：设袋中装有 r 只红球、t 只白球。每次自袋中任取一只球，观察其颜色然后放回，并再放入$\alpha$只，与所取出的那支球同色的球，若在袋中连续取球四次，试求第一、二次取到红球且第三、四次取到白球的概率
	- 设$A_i(i = 1, 2, 3, 4)$ 为事件“第 i 次取到红球”，则$A_3^-, A_4^-$ 为事件第三、四次取到白球。
	- 因此所求概率为
	<br> $P(A_1A_2A_3^-A_4^-)$
	<br>$= P(A_4^-|A_1A_2A_3^-)P(A_3^-|A_1A_2)P(A_2|A_1)P(A_1)$
	<br>$= \frac{t+a}{r+t+3a}\cdot \frac{t}{r+t+2a}\cdot \frac{r+a}{r+t+a}\cdot \frac{r}{r+t}$
	- **此模型被波利亚用来作为描述传染病的数学模型**

- 例 5：设某光学仪器厂制造的透镜，第一次落下时打破的概率为$ \frac{1}{2} $, 若第一次落下未打破，第二次落下打破的概率为 $ \frac{7}{10} $, 若前两次落下未打破，第三次落下打破的概率为 $ \frac{9}{10} $. 试求透镜落下三次而未打破的概率.
	- 以$A_i(i = 1, 2, 3)$ 表示事件“透镜第 i 次落下打破”，以 B 表示事件“透镜落下三次而未打破”。
	- 因为 $B = A_1^-A_2^-A_3^-$
	- 所以 $B = P(A_1^-A_2^-A_3^-) = P(A_3^-|A_1^-A_2^-)P(A_2^-|A_1^-)P(A_1^-)$
	<br>$= (1 - \frac{9}{10})(1 - \frac{7}{10})(1 - \frac{1}{2})$
	<br>$= \frac{3}{200}$

# 全概率公式与贝叶斯公式

## 样本空间的划分
- 定义：设$S$为试验$E$的样本空间，$B_1, B_2 \cdots, B_n$为$E$的一组事件，若
	1. $B_iB_j = \phi, i \neq j, i, j = 1, 2, \cdots, n$
	2. $B_1 \bigcup B_2 \bigcup \cdots \bigcup B_n = S$
- 则称$B_1, B_2, \cdots, B_n$为样本空间$S$的一个划分<br>[样本空间S](2.png)

## 全概率公式
- 定理：设试验$E$ 的样本空间为$S$, $A$为 E 的事件，$B_1, B_2, \cdots, B_n为S的一个划分，且 P(B_i)>0(i=1, 2, \cdots,n)$, 则<br>[全概率公式](3.png)
- 为全概率公式
- 说明：全概率公式的主要用处在于他可以讲一个复杂事件的概率计算问题，分解为若干个简单是件的概率计算问题，最后应用概率的可加性求出最终结果。其证明类似于例题 3 中抓阄的解答。
- [全概率图](4.png)

## 例题
- 有一批同一型号的产品，已知其中由一厂生产的占30%,二厂生产的占 50%，三厂生产的占 20%，又知这三个厂的产品次品率分别为 2%，1%，1%，问从这批产品中任取一件是次品的概率是多少？
	- 设事件$A$为“任取一件为次品”, 
	- 事件$B_i 为“任取一件为 i 厂的产品”,i = 1, 2, 3$
	- $B_1 \bigcup B_2 \bigcup B_2 = S$
	- $B_iB_j = \phi, i,j = 1, 2, 3$
	- [全概率图](4.png)
	- $P(A) = P(A|B_1)P(B_1) + P(A|B_2) + P(A|B_3)P(B_3) = 0.02 \times 0.3 + 0.01 \times 0.5 + 0.01 \times 0.2 = 0.013$

## 贝叶斯公式
- 定理：设试验 $E 的样本空间为 S. A 为 E 的事件，B_1, B_2 \cdots, B_n 为 S 的一个划分，且 P(A) > 0, P(B_i) > 0, (i = 1, 2, \cdots, n)$, 则：
- $P(B_i|A) = \frac{P(A|B_i)P(B_i)}{\sum_{j=1}^{n}P(A|B_j)P(B_j)}, i = 1, 2, \cdots, n.$
- 证明：
	- $P(B_i|A) = \frac{P(B_iA)}{P(A)}$
	<br>$= \frac{P(A|B_i)P(B_i)}{\sum_{j=1}^{n}P(A|B_j)P(B_j)}, i = 1, 2, \cdots, n.$

## 例题
- 某电子设备制造厂所用的元件是由三家元件制造厂提供的，根据以往的记录有以下的数据：
	| 元件制造厂 | 次品率 | 提供原件的份额 |
	|------------|--------|----------------|
	| 1          | 0.02   | 0.15           |
	| 2          | 0.01   | 0.80           |
	| 3          | 0.03   | 0.05           |
- 设这家三工厂的产品在仓库中是均匀混合的，且无区别的标志。
	- 在仓库中随机的取一只原件，求他是次品的概率；
	- 在仓库中随机的取一只原件，若已知取到的是次品，为分析此次品出自何厂，需求出此次品由三家工厂生产的概率分别是多少，试求这些概率。
- $设A表示“取到的是一只次品”，B_i(i =1, 2, 3), 表示“所取到的产品是由第 i 家工厂提供的”。则 B_1, B_2, B_3是样本空间 S 的一个划分$
<br>且$P(B_1) = 0.15, P(B_2) = 0.8, P(B_3) = 0.05,$
<br>$P(A|B_1) = 0.02, P(A|B_2) = 0.01, P(A|B_3) = 0.03$
